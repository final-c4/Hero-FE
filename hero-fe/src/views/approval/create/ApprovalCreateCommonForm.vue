<!--
 * <pre>
 * Vue Name        : ApprovalCreateCommonForm.vue
 * Description     : Í≥µÌÜµ ÏÑúÏãù
 *
 * Ïª¥Ìè¨ÎÑåÌä∏ Ïó∞Í≥Ñ
 * - Î∂ÄÎ™® Ïª¥Ìè¨ÎÑåÌä∏: ApprovalCreate.vue
 *
 * History
 *   2025/12/10 - ÎØºÏ≤† ÏµúÏ¥àÏûëÏÑ±
 *   2025/12/11 - props Îç∞Ïù¥ÌÑ∞ Î∞è ÎèôÏ†ÅÏª¥Ìè¨ÎÑåÌä∏ Ï∂îÍ∞Ä
 *   2025/12/14 - Í≥µÌÜµ Ïª¥Ìè¨ÎÑåÌä∏Ìôî
 *   2025/12/23 - ÎØºÏ≤† ÌååÏùºÎ™Ö Î≥ÄÍ≤Ω
 *   2025/12/24 - ÎØºÏ≤† ÏûëÏÑ± UI ÏµúÏ¢Ö Íµ¨ÌòÑ(Ï†úÎ™©/Î∂ÑÎ•ò/Í≤∞Ïû¨ÏÑ†/Ï∞∏Í≥†Î™©Î°ù ÏßÄÏ†ï)
 * </pre>
 *
 * @module approval
 * @author ÎØºÏ≤†
 * @version 2.1
 -->
<template>
  <div class="form-wrapper">
    <div class="paper-sheet">
      <div class="paper-padding">
        <div class="paper-content">

          <!-- Ï†úÎ™© ÏòÅÏó≠ -->
          <div class="title-section">
            <div class="title-row">
              <h1 class="main-title">{{ props.templateName }}</h1>
            </div>
          </div>

          <!-- ÏÉÅÎã® Ï†ïÎ≥¥ + Í≤∞Ïû¨ÏÑ† -->
          <div class="top-section">
            <div class="info-table">
              <div class="info-row">
                <div class="th-cell">
                  <span class="label-text">Í∏∞ÏïàÏûê</span>
                </div>
                <div class="td-cell">
                  <span class="value-text">{{ props.empName }}</span>
                </div>
              </div>
              <div class="info-row">
                <div class="th-cell">
                  <span class="label-text">ÏÜåÏÜç</span>
                </div>
                <div class="td-cell">
                  <span class="value-text">{{ props.empDept }}</span>
                </div>
              </div>
              <div class="info-row">
                <div class="th-cell">
                  <span class="label-text">Í∏∞ÏïàÏùº</span>
                </div>
                <div class="td-cell">
                  <span class="value-text">{{ currentDate }}</span>
                </div>
              </div>
              <div class="info-row">
                <div class="th-cell">
                  <span class="label-text">Î¨∏ÏÑúÎ≤àÌò∏</span>
                </div>
                <div class="td-cell">
                  <span class="value-text">-</span>
                </div>
              </div>
              <div class="info-row last-row">
                <div class="th-cell">
                  <span class="label-text">Î¨∏ÏÑúÎ∂ÑÎ•ò</span>
                </div>
                <div class="td-cell">
                  <span class="value-text">{{ props.category }}</span>
                </div>
              </div>
            </div>

            <!-- Í≤∞Ïû¨ ÎèÑÏû• ÏòÅÏó≠ -->
            <div class="stamp-area">
              <div class="stamp-group">

                <!-- ‚úÖ 1. Í∏∞ÏïàÏûê ÎèÑÏû• -->
                <div class="stamp-box">
                  <div class="stamp-header">
                    <span class="stamp-role-label">Í∏∞Ïïà</span>
                  </div>
                  <div class="stamp-body">
                    <div class="approver-info-vertical">
                      <div class="approver-name-row">
                        <span class="approver-name">{{ commonData.lines[0]?.approverName || authStore.user?.employeeName
                          }}</span>
                        <span class="approver-rank">{{ commonData.lines[0]?.gradeName || authStore.user?.gradeName
                          }}</span>
                      </div>
                      <span class="approver-dept">{{ commonData.lines[0]?.departmentName ||
                        authStore.user?.departmentName }}</span>
                    </div>
                    <div class="stamp-signature approved">
                      <div class="signature-text">
                        <span class="status-approved">Í∏∞Ïïà</span>
                      </div>
                    </div>
                  </div>
                  <div class="stamp-footer">
                    <span class="stamp-date">{{ currentDate || '-' }}</span>
                  </div>
                </div>

                <!-- ‚úÖ 2. 1Ï∞® Í≤∞Ïû¨Ïûê ÎèÑÏû• -->
                <div class="stamp-box">
                  <div class="stamp-header">
                    <span class="stamp-role-label">Í≤∞Ïû¨</span>
                  </div>
                  <div class="stamp-body">
                    <template v-if="commonData.lines[1]">
                      <div class="approver-info-vertical">
                        <div class="approver-name-row">
                          <span class="approver-name">{{ commonData.lines[1].approverName }}</span>
                          <span class="approver-rank">{{ commonData.lines[1].gradeName }}</span>
                        </div>
                        <span class="approver-dept">{{ commonData.lines[1].departmentName }}</span>
                      </div>
                      <div class="stamp-signature pending">
                        <div class="signature-text">
                          <span class="status-pending">ÎåÄÍ∏∞</span>
                        </div>
                      </div>
                    </template>
                    <template v-else>
                      <div class="approver-info-vertical">
                        <span class="approver-name empty">ÎØ∏ÏßÄÏ†ï</span>
                      </div>
                      <div class="stamp-signature empty">
                        <div class="signature-text">
                          <span class="status-empty">-</span>
                        </div>
                      </div>
                    </template>
                  </div>
                  <div class="stamp-footer">
                    <span class="stamp-date">{{ commonData.lines[1] ? '-' : '' }} -</span>
                  </div>
                </div>

                <!-- ‚úÖ 3. 2Ï∞® Í≤∞Ïû¨Ïûê ÎèÑÏû• -->
                <div class="stamp-box">
                  <div class="stamp-header">
                    <span class="stamp-role-label">Í≤∞Ïû¨</span>
                  </div>
                  <div class="stamp-body">
                    <template v-if="commonData.lines[2]">
                      <div class="approver-info-vertical">
                        <div class="approver-name-row">
                          <span class="approver-name">{{ commonData.lines[2].approverName }}</span>
                          <span class="approver-rank">{{ commonData.lines[2].gradeName }}</span>
                        </div>
                        <span class="approver-dept">{{ commonData.lines[2].departmentName }}</span>
                      </div>
                      <div class="stamp-signature pending">
                        <div class="signature-text">
                          <span class="status-pending">ÎåÄÍ∏∞</span>
                        </div>
                      </div>
                    </template>
                    <template v-else>
                      <div class="approver-info-vertical">
                        <span class="approver-name empty">ÎØ∏ÏßÄÏ†ï</span>
                      </div>
                      <div class="stamp-signature empty">
                        <div class="signature-text">
                          <span class="status-empty">-</span>
                        </div>
                      </div>
                    </template>
                  </div>
                  <div class="stamp-footer">
                    <span class="stamp-date">{{ commonData.lines[2] ? '-' : '' }} -</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Î©îÏù∏ Ìèº ÏòÅÏó≠ -->
          <div class="form-section">

            <!-- Í≥µÌÜµ ÏûÖÎ†• ÏÑπÏÖò -->
            <div class="main-form-section">

              <!-- Ï†úÎ™© ÏûÖÎ†• Î∂ÄÎ∂Ñ -->
              <div class="form-row">
                <div class="row-label-top">
                  <span class="label-text">Ï†úÎ™©</span>
                </div>
                <div class="row-content">
                  <input v-model="commonData.title" type="text" class="input-wrapper" placeholder="Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" />
                </div>
              </div>

              <!-- Í≤∞Ïû¨ÏÑ† -->
              <div class="form-row">
                <div class="row-label">
                  <span class="label-text">Í≤∞Ïû¨ÏÑ†</span>
                </div>
                <div class="row-content flow-content">
                  <div class="approval-flow">

                    <!-- ‚úÖ Í∏∞Ï°¥ template v-for Íµ¨Ï°∞ Í∑∏ÎåÄÎ°ú Ïú†ÏßÄÌïòÎ©∞ ÎèôÏ†Å Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö© -->
                    <template v-for="(approver, index) in commonData.lines" :key="index">
                      <div class="flow-card">
                        <div class="card-inner">
                          <div class="avatar-circle">
                            <span class="avatar-text">{{ approver.approverName?.charAt(0) }}</span>
                          </div>
                          <div class="card-details">
                            <div class="detail-row">
                              <span class="detail-name">{{ approver.approverName }} {{ approver.gradeName }}</span>
                            </div>
                            <div class="detail-row">
                              <span class="detail-dept">{{ approver.departmentName }}</span>
                            </div>
                            <div class="detail-row">
                              <span class="detail-role"
                                :style="{ color: index === 0 ? '#1c398e' : '#62748e', fontWeight: index === 0 ? '600' : '400' }">
                                {{ index === 0 ? 'Í∏∞Ïïà' : 'Í≤∞Ïû¨' }}
                              </span>
                            </div>
                          </div>
                        </div>

                        <img v-if="index !== 0" class="btn-delete" src="/images/deletebutton.svg"
                          @click="removeApprover(index)" alt="ÏÇ≠Ï†ú" />
                      </div>

                      <img v-if="index < commonData.lines.length - 1 || commonData.lines.length < 3" class="flow-arrow"
                        src="/images/linearrow.svg" alt="ÌôîÏÇ¥Ìëú" />
                    </template>

                    <button v-if="commonData.lines.length < 3" class="flow-card add-card" @click="openModal('LINE')"
                      type="button">
                      <div class="add-icon">
                        <img src="/images/plus-dark.svg" alt="Í≤∞Ïû¨ÏûêÏ∂îÍ∞Ä">
                      </div>
                    </button>

                  </div>
                </div>
              </div>

              <!-- Ï∞∏Ï°∞ -->
              <div class="form-row">
                <div class="row-label">
                  <span class="label-text">Ï∞∏Ï°∞</span>
                </div>
                <div class="row-content ref-content">
                  <div class="reference-wrapper">

                    <!-- ‚úÖ Í∏∞Ï°¥ v-if, v-for Íµ¨Ï°∞ Í∑∏ÎåÄÎ°ú Ïú†ÏßÄÌïòÎ©∞ ÎèôÏ†Å Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö© -->
                    <div v-if="commonData.references.length > 0" class="ref-chip-list">
                      <div v-for="(refMember, index) in commonData.references" :key="index" class="ref-chip">
                        <span class="ref-name">{{ refMember.referencerName }} {{ refMember.gradeName }} {{
                          refMember.departmentName
                        }}</span>
                        <button class="btn-ref-delete" @click="removeReference(index)" type="button">
                          <img src="/images/deletebutton.svg" alt="ÏÇ≠Ï†ú" width="10" height="10" />
                        </button>
                      </div>
                    </div>

                    <button class="btn-add-ref" @click="openModal('REF')" type="button">
                      <img src="/images/plus-dark.svg" alt="Ï∂îÍ∞Ä" width="12" height="12" />
                      <span class="btn-text-sm">Ï∞∏Ï°∞ Ï∂îÍ∞Ä</span>
                    </button>

                  </div>
                </div>
              </div>

              <Teleport to="body">
                <div v-if="isModalOpen" class="modal-overlay" @click.self="closeModal">
                  <ApprovalLineModal :type="modalType" @close="closeModal" @save="handleModalSave" />
                </div>
              </Teleport>

              <!-- Ï≤®Î∂ÄÌååÏùº -->
              <div class="form-row">
                <div class="row-label">
                  <span class="label-text">Ï≤®Î∂ÄÌååÏùº</span>
                </div>

                <div class="row-content file-content">

                  <div class="upload-left-section">
                    <div class="file-upload-box" @click="triggerFileUpload">
                      <img class="icon-upload" src="/images/fileupload.svg" />
                      <div class="upload-text-wrap">
                        <span class="upload-label">ÌååÏùº ÏÑ†ÌÉù</span>
                      </div>
                      <input type="file" ref="fileInput" class="hidden-file-input" multiple @click.stop
                        @change="handleFileUpload" />
                    </div>
                    <div class="file-desc">
                      <span class="desc-text">ÏµúÎåÄ 10MB, Ïó¨Îü¨ ÌååÏùº Ï≤®Î∂Ä Í∞ÄÎä•</span>
                    </div>
                  </div>

                  <div v-if="commonData.attachments.length > 0" class="uploaded-file-list">
                    <div v-for="(file, index) in commonData.attachments" :key="index" class="file-item">
                      <div class="file-info">
                        <img class="icon-clip" src="/images/file.svg" alt="file" />
                        <span class="file-name">{{ file.name }}</span>
                        <span class="file-size">{{ formatFileSize(file.size) }}</span>
                      </div>
                      <button class="btn-remove-file" @click.stop="removeFile(index)">
                        <img src="/images/deletebutton.svg" alt="ÏÇ≠Ï†ú" width="14" />
                      </button>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <!-- ÎèôÏ†Å ÏÉÅÏÑ∏ Ìèº ÏÑπÏÖò (Ïä¨Î°ØÏúºÎ°ú Í∞Å ÏÑúÏãùÎ≥Ñ Ïª¥Ìè¨ÎÑåÌä∏ Ï£ºÏûÖ) -->
            <slot name="detail-section"></slot>

          </div>
        </div>

        <!-- ÌïòÎã® Î≤ÑÌäº -->
        <div class="action-buttons">
          <button class="btn-secondary" @click="onPreview">
            <img class="btn-icon" src="/images/file.svg" />
            <span class="btn-text">ÏûÑÏãúÏ†ÄÏû•</span>
          </button>
          <button class="btn-secondary" @click="onCancel">
            <img class="btn-icon" src="/images/cancel.svg" />
            <span class="btn-text">ÏûëÏÑ±Ï∑®ÏÜå</span>
          </button>
          <button class="btn-primary" @click="onSubmit">
            <img class="btn-icon" src="/images/submit.svg" />
            <span class="btn-text-white">ÏÉÅÏã†</span>
          </button>
        </div>

      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { useApprovalTemplateStore } from '@/stores/approval/approval.store';
import { useAuthStore } from '@/stores/auth';
import { ref, reactive, computed, onMounted, watch } from 'vue';
import { storeToRefs } from 'pinia';
import {
  ApprovalDefaultLineDTO,
  ApprovalDefaultReferenceDTO
} from '@/types/approval/template.types';
import ApprovalLineModal from '@/views/approval/create/forms/ApprovalLineModal.vue';

const templateStore = useApprovalTemplateStore();
const authStore = useAuthStore();
const { template } = storeToRefs(templateStore);

const props = defineProps<{
  templateId: number;
  templateName: string;
  category: string;
  empName: string;
  empDept: string;
  empGrade: string;
}>();

// emit
const emit = defineEmits<{
  (e: 'preview'): void
  (e: 'cancel'): void
  (e: 'submit'): void
}>();

// Í≥µÌÜµ Îç∞Ïù¥ÌÑ∞ ÏßÅÏ†ë ÏûÖÎ†•ÌïòÎäî Ï†úÎ™©/Í≤∞Ïû¨ÏÑ†/Ï∞∏Ï°∞/Ï≤®Î∂ÄÌååÏùº
const commonData = reactive({
  title: '',
  lines: [] as ApprovalDefaultLineDTO[],
  references: [] as ApprovalDefaultReferenceDTO[],
  attachments: [] as File[]
});

onMounted(async () => {
  await initializeData();
});

// ‚úÖ watchÎ°ú template Î≥ÄÍ≤Ω Í∞êÏßÄ
watch(
  () => template.value,
  (newTemplate) => {
    if (newTemplate && newTemplate.templateId) {
      console.log('üìã template Î°úÎìú ÏôÑÎ£å, Ïû¨Ï¥àÍ∏∞Ìôî');
      initializeData();
    }
  }
);

/**
 * Í∏∞Î≥∏Í≤∞Ïû¨ÏÑ† Î∞è Ï∞∏Ï°∞Ïûê Ï¥àÍ∏∞Ìôî
 * - Í∏∞ÏïàÏûê Ï†ïÎ≥¥Î•º Ï≤´ Î≤àÏß∏ Í≤∞Ïû¨ÏÑ†ÏúºÎ°ú ÏÑ§Ï†ï
 * - APIÏóêÏÑú Î∞õÏùÄ Í∏∞Î≥∏Í≤∞Ïû¨ÏÑ†ÏùÑ 2Ï∞® Í≤∞Ïû¨ÏÑ†Î∂ÄÌÑ∞ Ï∂îÍ∞Ä
 * - APIÏóêÏÑú Î∞õÏùÄ Ï∞∏Ï°∞Ïûê Î™©Î°ù ÏÑ§Ï†ï
 */
const initializeData = async () => {
  try {
    // 1. Í∏∞ÏïàÏûê Ï†ïÎ≥¥ ÏÑ§Ï†ï (Ï≤´ Î≤àÏß∏ Í≤∞Ïû¨ÏÑ†)
    const currentUser = authStore.user || {
      employeeId: 0,
      employeeName: props.empName,
      departmentId: 0,
      departmentName: props.empDept,
      gradeName: props.empGrade,
      jobTitleName: ''
    };

    const drafterLine: ApprovalDefaultLineDTO = {
      seq: 1,
      approverId: currentUser.employeeId,
      approverName: currentUser.employeeName,
      departmentId: currentUser.departmentId,
      departmentName: currentUser.departmentName,
      gradeName: currentUser.gradeName,
      jobTitleName: currentUser.jobTitleName,
    };

    // 2. API ÏùëÎãµ Îç∞Ïù¥ÌÑ∞ ÌôïÏù∏
    if (!template.value || !template.value.lines) {
      console.warn('‚ö†Ô∏è Í∏∞Î≥∏Í≤∞Ïû¨ÏÑ† Ï†ïÎ≥¥Í∞Ä ÏóÜÏùå. Îπà Í≤∞Ïû¨ÏÑ†ÏúºÎ°ú Ï¥àÍ∏∞Ìôî.');
      commonData.lines = [drafterLine];
      commonData.references = [];
      return;
    }

    // 3. APIÏóêÏÑú Î∞õÏùÄ Í∏∞Î≥∏Í≤∞Ïû¨ÏÑ† Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
    // template.valueÎäî ApprovalCreate.vueÏùò onMountedÏóêÏÑú 
    // fetchTemplate(templateId)Î°ú Ïù¥ÎØ∏ Ï°∞ÌöåÎêú ÏÉÅÌÉú
    const defaultLines = template.value.lines;

    // 4. Í∏∞ÏïàÏûê + API Í∏∞Î≥∏Í≤∞Ïû¨ÏÑ† Î≥ëÌï©
    commonData.lines = [drafterLine, ...defaultLines];

    // 5. APIÏóêÏÑú Î∞õÏùÄ Ï∞∏Ï°∞Ïûê Î™©Î°ù ÏÑ§Ï†ï
    commonData.references = template.value.references || [];

    console.log('‚úÖ Í≤∞Ïû¨ÏÑ† Ï¥àÍ∏∞Ìôî ÏôÑÎ£å:', {
      Ï¥ùÍ≤∞Ïû¨ÏÑ†: commonData.lines.length,
      Í≤∞Ïû¨Ïûê: commonData.lines.map(l => l.approverName),
      Ï∞∏Ï°∞Ïûê: commonData.references.map(r => r.referencerName)
    });

  } catch (error) {
    console.error('‚ùå Í≤∞Ïû¨ÏÑ† Ï¥àÍ∏∞Ìôî Ï§ë Ïò§Î•ò:', error);

    // ÏµúÏÜåÌïú Í∏∞ÏïàÏûêÎßåÏù¥ÎùºÎèÑ ÏÑ§Ï†ï
    const currentUser = authStore.user || {
      employeeId: 0,
      employeeName: props.empName,
      departmentId: 0,
      departmentName: props.empDept,
      gradeName: props.empGrade,
      jobTitleName: ''
    };

    commonData.lines = [{
      seq: 1,
      approverId: currentUser.employeeId,
      approverName: currentUser.employeeName,
      departmentId: currentUser.departmentId,
      departmentName: currentUser.departmentName,
      gradeName: currentUser.gradeName,
      jobTitleName: currentUser.jobTitleName,
    }];
    commonData.references = [];
  }
};


const removeApprover = (index: number) => {
  if (index === 0) {
    alert("Í∏∞ÏïàÏûê(Î≥∏Ïù∏)Îäî Í≤∞Ïû¨ÏÑ†ÏóêÏÑú Ï†úÏô∏Ìï† Ïàò ÏóÜÏäµÎãàÎã§.");
    return;
  }

  commonData.lines.splice(index, 1);

  commonData.lines.forEach((line, idx) => {
    line.seq = idx + 3;
  });
};

const isModalOpen = ref(false);
const modalType = ref<'LINE' | 'REF'>('LINE');

const openModal = (type: 'LINE' | 'REF') => {
  modalType.value = type;
  isModalOpen.value = true;
};

const closeModal = () => {
  isModalOpen.value = false;
};

const handleModalSave = (selectedUsers: any[]) => {
  if (modalType.value === 'LINE') {

    const currentCount = commonData.lines.length;
    const addCount = selectedUsers.length;

    if (currentCount + addCount > 3) {
      alert("Í≤∞Ïû¨ÏÑ†ÏùÄ Î≥∏Ïù∏ Ìè¨Ìï® ÏµúÎåÄ 3Îã®Í≥ÑÍπåÏßÄÎßå ÏßÄÏ†ï Í∞ÄÎä•Ìï©ÎãàÎã§.");
      return;
    }

    const startSeq = currentCount + 1;

    const newLines: ApprovalDefaultLineDTO[] = selectedUsers.map((user, idx) => ({
      templateId: props.templateId,
      approverId: user.employeeId,
      approverName: user.employeeName,
      departmentId: user.departmentId,
      departmentName: user.departmentName,
      gradeName: user.gradeName,
      jobTitleName: user.jobTitleName || '',
      seq: startSeq + idx,
    }));

    commonData.lines.push(...newLines);

  } else {

    const newRefs: ApprovalDefaultReferenceDTO[] = selectedUsers.map(user => ({
      templateId: props.templateId,
      referencerId: user.employeeId,
      referencerName: user.employeeName,
      departmentId: user.departmentId,
      departmentName: user.departmentName,
      gradeName: user.gradeName,
      jobTitleName: user.jobTitleName || '',
    }));

    newRefs.forEach(newRef => {
      const exists = commonData.references.some(r => r.referencerId === newRef.referencerId);
      if (!exists) {
        commonData.references.push(newRef);
      }
    });
  }
  closeModal();
};

const removeReference = (index: number) => {
  commonData.references.splice(index, 1);
};

const currentDate = computed(() => {
  const today = new Date();
  const year = today.getFullYear();
  const month = String(today.getMonth() + 1).padStart(2, '0');
  const day = String(today.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
});

const fileInput = ref<HTMLInputElement | null>(null);

const triggerFileUpload = () => fileInput.value?.click();

const handleFileUpload = (event: Event) => {
  const target = event.target as HTMLInputElement;
  if (target.files && target.files.length > 0) {
    commonData.attachments = [
      ...commonData.attachments,
      ...Array.from(target.files)
    ];
  }

  if (target.value) target.value = '';
};
const removeFile = (index: number) => commonData.attachments.splice(index, 1);
const formatFileSize = (bytes: number) => {
  if (bytes === 0) return '0 B';
  const k = 1024;
  const sizes = ['B', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
};

const getCommonData = () => ({
  title: commonData.title,
  lines: commonData.lines,
  attachments: commonData.attachments,
  references: commonData.references
});

const onPreview = () => emit('preview');
const onCancel = () => emit('cancel');
const onSubmit = () => emit('submit');

defineExpose({ getCommonData });
</script>

<style scoped>
@import "@/assets/styles/approval/commonform.css";

.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.file-content {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: 16px;
  width: 100%;
}

.upload-left-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
  flex-shrink: 0;
}

.uploaded-file-list {
  flex-grow: 1;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  background-color: #f8fafc;
  padding: 8px;
  max-height: 72px;
  overflow-y: auto;
}

.uploaded-file-list::-webkit-scrollbar {
  width: 6px;
}

.uploaded-file-list::-webkit-scrollbar-thumb {
  background-color: #cbd5e1;
  border-radius: 3px;
}

.file-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background-color: #ffffff;
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  padding: 6px 10px;
  margin-bottom: 6px;
  font-size: 13px;
}

.file-item:last-child {
  margin-bottom: 0;
}

.file-info {
  display: flex;
  align-items: center;
  gap: 8px;
  overflow: hidden;
}

.icon-clip {
  width: 14px;
  height: 14px;
  opacity: 0.6;
}

.file-name {
  color: #334155;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 200px;
}

.file-size {
  color: #94a3b8;
  font-size: 12px;
  white-space: nowrap;
}

.btn-remove-file {
  background: none;
  border: none;
  cursor: pointer;
  padding: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.6;
  transition: opacity 0.2s;
}

.btn-remove-file:hover {
  opacity: 1;
}

.hidden-file-input {
  display: none;
}

/* Bounce Animation */
.dialog-bounce-enter-active,
.dialog-bounce-leave-active,
.dialog-bounce-enter-active .el-dialog,
.dialog-bounce-leave-active .el-dialog {
  transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.dialog-bounce-enter-from,
.dialog-bounce-leave-to {
  opacity: 0;
}

.dialog-bounce-enter-from .el-dialog,
.dialog-bounce-leave-to .el-dialog {
  transform: scale(0.3) translateY(-50px);
  opacity: 0;
}
</style>